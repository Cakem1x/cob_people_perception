<?xml version="1.0"?>

<launch>
  <!-- Openni people segmentation and tracker - adapted to publish the segmented image (comment out if you do not use the openni-tracker) -->
  <!-- <node pkg="cob_people_detection" ns="cob_people_detection/openni_tracker" type="openni_tracker" name="openniTrackerNode" output="screen"/-->

  <!-- nodelet manager  (starts somewhere else) -->
  <!-- <node pkg="nodelet" type="nodelet" name="nodelet_manager"  args="manager" output="screen"/> -->

  <!-- face detection and recognition nodelet (detects faces in range and color image and publishes their positions) -->
  <rosparam command="load" ns="cob_people_detection/face_detection" file="$(find cob_people_detection)/ros/launch/face_detection_params.yaml"/>
  <node pkg="nodelet" ns="cob_people_detection/face_detection" type="nodelet" name="CobFaceDetectionNodelet" args="load ipa_PeopleDetector/CobFaceDetectionNodelet /nodelet_manager" output="screen">
    <remap from="pointcloud" to="/camera/depth/points"/>
    <remap from="colorimage" to="/camera/rgb/image_color"/>
	
    <param name="data_directory" type="string" value="$(find cob_people_detection)/common/files/windows/"/>
  </node>

  <!-- People detection and tracking nodelet (fuses results from face detection/recognition and people segmentation, basic tracking functions) -->
  <rosparam command="load" ns="cob_people_detection" file="$(find cob_people_detection)/ros/launch/people_detection_params.yaml"/>
  <node pkg="nodelet" ns="cob_people_detection" type="nodelet" name="CobPeopleDetectionNodelet" args="load ipa_PeopleDetector/CobPeopleDetectionNodelet /nodelet_manager" output="screen" >
    <remap from="people_segmentation_image" to="/cob_people_detection/openni_tracker/people_segmentation_image"/>
    <remap from="colorimage" to="/camera/rgb/image_color"/>
    <remap from="face_position_array_in" to="/cob_people_detection/face_detection/face_position_array"/>
  </node>

  <!-- Image viewer displays -->
  <node name="image_view1" pkg="image_view" type="image_view" respawn="false" output="screen">
    <remap from="image" to="/cob_people_detection/face_detection/face_detection_image"/>
  </node>
  <node name="image_view2" pkg="image_view" type="image_view" respawn="false" output="screen">
    <remap from="image" to="/cob_people_detection/people_detection_image"/>
  </node>
  <node name="image_view3" pkg="image_view" type="image_view" respawn="false" output="screen">
    <remap from="image" to="/cob_people_detection/openni_tracker/people_segmentation_image"/>
  </node>

</launch>
